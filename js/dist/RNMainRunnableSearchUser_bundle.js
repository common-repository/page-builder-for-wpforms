rndefine("#RNMainRunnableSearchUser",["exports","#RNMainRunnableSearchBar/RunnableSearchFieldBase","#RNMainCore/EventManager","#RNMainRunnableSearchBar/RunnableSearchFieldBase.Options","#RNMainCore/WpAjaxPost","#RNMainCore/Sanitizer"],(function(e,a,t,r,n,s){"use strict";class i extends r.RunnableSearchFieldBaseOptions{LoadDefaultValues(){super.LoadDefaultValues(),this.UserSearchType=""}}class l extends a.RunnableSearchFieldBase{constructor(e,a){super(e,a),this.Container.setAttribute("multiple","multiple"),this.Container.removeAttribute("disabled");let t=this.Container.querySelectorAll("option[selected]"),r=[];this.Map=new Map,t.forEach((e=>{this.Map.set(e.value,e.innerText),r.push({Id:e.value,Label:e.innerText})})),this.TomSelect=new TomSelect(this.Container,{valueField:"Id",labelField:"Label",searchField:"Label",options:r,plugins:["remove_button"],load:async(e,a)=>{if("User"==this.Options.UserSearchType){let t=await n.WpAjaxPost.Post("pb_search_user",{Query:e,Nonce:this.SearchBar.Page.GetPostItem("SearchUserNonce","")});if(null==t)return void a();t.forEach((e=>this.Map.set(e.Id,e.Label))),a(t)}else{let t=await n.WpAjaxPost.Post("pb_search_role",{Query:e,Nonce:this.SearchBar.Page.GetPostItem("SearchRoleNonce","")});if(null==t)return void a();t.forEach((e=>this.Map.set(e.Id,e.Label))),a(t)}}}),this.TomSelect.setValue(r.map((e=>e.Id)))}GetWasFilled(){return s.Sanitizer.SanitizeStringArray(this.TomSelect.getValue()).length>0}InternalGetSearchInfo(){let e=this.TomSelect.getValue(),a=[];return e.forEach((e=>{a.push({Id:e,Label:this.Map.get(e)})})),a}}t.EventManager.Subscribe("GetSearchField",(e=>{if("User"==e.Options.SearchType)return new l(e.SearchBar,(new i).Merge(e.Options))})),e.RunnableSearchUser=l,Object.defineProperty(e,"__esModule",{value:!0})}));
